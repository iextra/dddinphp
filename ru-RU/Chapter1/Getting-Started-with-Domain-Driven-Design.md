# 1. Начало работы с предметно-ориентированным дизайном
Так в чем же весь этот шум? Проектирование на основе предметной области, или DDD, — это подход,
который помогает нам добиться успеха в понимании и создании проектов моделей программного обеспечения.
Он предоставляет нам инструменты стратегического и тактического моделирования,
помогающие разрабатывать высококачественное программное обеспечение, отвечающее нашим бизнес-целям.

Что еще более важно, **предметно-ориентированное проектирование не связано с технологиями**.
Вместо этого речь идет о развитии знаний о бизнесе и использовании технологий для создания ценности.
Только после того, как вы поймете бизнес, в котором работает ваша компания,
вы сможете участвовать в процессе разработки модели программного обеспечения для создания **универсального языка**.

## 1.1 Почему предметно-ориентированное проектирование?
- Программное обеспечение должно иметь смысл не только для программистов, но и для бизнеса.
  При проектировании, ориентированном на предметную область, особое внимание уделяется тому,
  чтобы предприятия и программное обеспечение говорили на одном языке.

- Программное обеспечение является наиболее ценным артефактом. Это реализация вашей модели предметной области.
- Благодаря предметно-ориентированному проектированию каждый учится и вносит свой вклад в изучение бизнес-домена.
- Знания больше не принадлежат только разработчикам; с доменно-ориентированным дизайном каждый
  знает, что происходит с бизнесом.
- Между экспертами предметной области нет переводов, что означает отсутствие потери информации или
  утомительной синхронизации.
- Дизайн – это код, а код – это дизайн. Кодекс — единственная истина для общего язык.
- Проектирование, ориентированное на предметную область, обеспечивает основу для стратегического
  и тактического проектирования — от стратегического до определить наиболее важные области для развития,
  исходя из бизнес-ценности, и тактически построить рабочую модель предметной области из проверенных в боевых условиях
  строительных блоков и шаблонов.

## 1.2 Чем помогает предметно-ориентированное проектирование?
Domain-Driven Design (DDD) это подход к разработке программного обеспечения,
который сосредоточен на трех столпах:

1. Повсеместный язык. Эксперты предметной области и разработчики программного обеспечения работают вместе,
   чтобы создать общий язык для разрабатываемых областей бизнеса. Не существует «мы против них»; это всегда мы.
   Разработка программного обеспечения — это бизнес-инвестиция, а не просто затраты.
   Усилия по созданию универсального языка помогают распространить глубокое понимание предметной области
   среди всех членов команды.
2. Стратегический дизайн: проектирование, ориентированное на предметную область, касается стратегии направления бизнеса,
   а не только технических аспектов. Это помогает определить внутренние взаимоотношения
   и системы обратной связи раннего предупреждения. С технической стороны стратегическое проектирование защищает
   каждую бизнес-услугу, обеспечивая мотивацию для создания сервис-ориентированной архитектуры.
3. Тактическое проектирование: проектирование, управляемое предметной областью, предоставляет инструменты
   и строительные блоки для итеративных результатов программного обеспечения.
   Инструменты тактического проектирования создают программное обеспечение, которое не только корректно,
   но и тестируется и менее подвержено ошибкам.

## 1.2.1 Повсеместный язык
Наряду с ограниченными контекстами, вездесущий язык является одной из главных сильных сторон
предметно-ориентированного дизайна.

````
С точки зрения контекста
А пока представьте, что ограниченный контекст — это концептуальная граница вокруг системы. 
Вездесущий язык внутри границ имеет особое контекстуальное значение. 
Понятия вне этого контекста могут иметь разные значения.
````

Итак, как уловить этот особый язык?
- Определить ключевые бизнес-процессы, их входы и результаты.
- Создайте глоссарий терминов и определений.
- Опишите важные концепции программного обеспечения с помощью какой-либо документации.
- Делитесь и расширяйте собранные знания с остальной частью команды
  (разработчиками и Эксперты по предметной области).

С момента появления предметно-ориентированного проектирования появились новые методы
улучшения процесса создания универсального языка. Наиболее важным из них, который сейчас используется все чаще,
является Event Storming.

## 1.3 Стоит ли мне рассматривать предметно-ориентированное проектирование как вариант?
Доменно-ориентированное проектирование — это не панацея; как и все в программном обеспечении, это зависит от контекста.
Как правило, используйте его для упрощения вашего домена, но никогда для усложнения.

Если ваше приложение ориентировано на данные и ваши варианты использования в основном манипулируют
строками в базе данных и выполняют операции CRUD, то есть создание, чтение, обновление и удаление,
вам не требуется доменно-ориентированное проектирование. Единственное, что нужно вашей компании, —
это красивое лицо перед вашей базой данных.

Если ваше приложение имеет менее 30 вариантов использования, возможно, для обработки вашей бизнес-логики
будет проще использовать такую среду, как Symfony или Laravel.

Если у вас более 30 вариантов использования, возможно, ваша система приближается к ужасному [«Большому комку грязи»](https://en.wikipedia.org/wiki/Anti-pattern#Software_engineering_anti-patterns).
Если вы точно знаете, что ваша система будет усложняться, вам следует рассмотреть возможность использования
доменно-ориентированного проектирования для борьбы со сложностью.

Если вы знаете, что ваше приложение будет расти и часто меняться, предметно-ориентированное проектирование определенно
поможет справиться со сложностью и провести рефакторинг вашей модели с течением времени.

Если вы не понимаете домен, над которым работаете, потому что он новый и никто раньше не инвестировал в решение,
это может означать, что оно достаточно сложное, чтобы вы могли начать применять доменно-ориентированное проектирование.
Вам нужно будет тесно сотрудничать с экспертами по предметной области, чтобы правильно построить модели.

## 1.4 Основные проблемы применения предметно-ориентированного проектирования
На пути к применению предметно-ориентированного проектирования вы столкнетесь с рядом проблем.

Применение предметно-ориентированного проектирования предполагает размышление о бизнес-домене, терминологии,
исследованиях и сотрудничестве с экспертами в предметной области, а не программирование жаргона.
Это потребует времени и усилий.

Вам необходимо заручиться поддержкой экспертов в предметной области для участия в процессе создания
программного обеспечения. Вам понадобятся эксперты по предметной области, чтобы получить глубокие знания
в предметной области. Это потребует открытый, здоровый, уважительный и непрерывный разговор с экспертами для
моделирования их разговорной речи в программном обеспечении.

Мы, разработчики, — технические мыслители; технические решения – наша специализация.
Думать о технических проблемах само по себе неплохо, но реальность такова, что иногда лучше думать менее технически.
Чтобы думать о поведении объектов, нам нужно сначала думать на вездесущем языке.

## 1.5 Бизнес-ценность использования предметно-ориентированного проектирования
Лучший способ оправдать технологию или метод – это обеспечить ценность для бизнеса.
Подводя итог, вот основные преимущества применения предметно-ориентированного проектирования:

- Полезная и содержательная модель своей предметной области.
- Эксперты предметной области участвуют в разработке программного обеспечения.
- Улучшенный пользовательский опыт.
- Четкие границы
- Лучшая организация архитектуры
- Итеративное и непрерывное моделирование в гибкой манере.
- Лучшие инструменты, как стратегические, так и тактические.

## 1.6 Стратегический обзор
Чтобы получить общий обзор стратегической стороны предметно-ориентированного проектирования, мы воспользуемся подходом, 
использованным в книге Джимми Нильсона [«Применение предметно-ориентированного проектирования и шаблонов»](https://www.amazon.com/Applying-Domain-Driven-Design-Patterns-Examples/dp/0321268202). 
Рассмотрим два разных пространства: пространство проблем и пространство решений.

В проблемном пространстве доменно-ориентированное проектирование использует домены и поддомены для группировки 
и организации того, что компании хотят решить. В случае онлайн-турагентства (ОТА) проблема заключается в таких вещах, 
как авиабилеты и бронирование отелей. Такой домен может быть организован в различные поддомены, 
такие как ценообразование, инвентарь, управление пользователями и т.д.

В области решений предметно-ориентированное проектирование предоставляет ограниченные контексты, 
карты контекстов и сопоставления контекстов. Их цель — определить, как обеспечить реализацию всех 
идентифицированных поддоменов, определяя их взаимодействия и детали этих взаимодействий. 
Продолжая пример OTA, каждый из поддоменов будет решен с помощью реализации ограниченного контекста — например, 
специальное веб-приложение, разработанное командой для поддомена управления ценами, 
и готовое решение для поддомена управления пользователями. Карта контекста покажет, как каждый ограниченный контекст 
связан с остальными. Внутри карты контекстов мы можем увидеть, какой тип отношений имеют два ограниченных контекста 
(например, клиент-поставщик, партнеры). Идеальный подход — реализовать каждый поддомен одним ограниченным контекстом,
но это не всегда возможно.

С точки зрения реализации, следуя доменно-ориентированному проектированию, вы в конечном итоге получите 
распределенную архитектуру. Как вы, возможно, уже знаете, распределенные архитектуры более сложны, чем монолитные, 
так чем же интересен этот подход, особенно для больших и сложных компаний? Действительно ли оно того стоит? 
Ну, это так. Доказано, что распределенные архитектуры повышают общую производительность компании, 
поскольку они определяют границы вашего продукта, который может разрабатываться целенаправленными командами. 
Если ваш домен — проблема, которую вам нужно решить, — не сложен, применение стратегической части 
доменно-ориентированного проектирования может добавить ненужные накладные расходы и замедлить скорость разработки.

Если вы хотите узнать больше о стратегической части предметно-ориентированного проектирования, 
вам следует взглянуть на первые три главы книги Вона Вернона [«Реализация предметно-ориентированного проектирования»](https://www.amazon.com/Implementing-Domain-Driven-Design-Vaughn-Vernon-ebook/dp/B00BCLEBN8) 
или книгу [«Domain-Driven Design»](https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215) 
Эрика Эванса, обе книги которые специально ориентированы на этот аспект.

## 1.7 Другие связанные направления: микросервисы и автономные системы
Существуют и другие движения, продвигающие архитектуры, которые следуют тем же принципам, что и доменно-ориентированное
проектирование. Хорошими примерами этого являются микросервисы и автономные системы.

````
Архитектурный стиль микросервисов — это подход к разработке одного приложения как набора небольших сервисов, 
каждый из которых работает в своем собственном процессе и взаимодействует с помощью облегченных механизмов, 
часто API-интерфейса HTTP-ресурсов. Эти услуги построены на основе бизнес-возможностей, а также могут быть развернуты 
независимо с использованием полностью автоматизированного оборудования. Существует минимум централизованного управления 
этими сервисами, которые могут быть написаны на разных языках программирования, 
а также использовать разные технологии хранения данных.
````
Именно так Джеймс Льюис и Мартин Фаулер определяют микросервисы в своем [Руководстве по ресурсам микросервисов](https://martinfowler.com/microservices/). 
Взгляните на него, если хотите узнать больше о микросервисах.

Как это связано с предметно-ориентированным дизайном? Как объясняется в книге Сэма Ньюмана [«Создание микросервисов»](https://www.amazon.com/Building-Microservices-Sam-Newman/dp/1491950358),
микросервисы — это реализации ограниченных контекстов, управляемых предметной областью.

Другое момент — Автономная система (SCS). Это архитектура, которая фокусируется на разделении функциональности 
на множество независимых систем, что делает полную логическую систему совместной работой множества 
более мелких программных систем. Это позволяет избежать проблемы больших монолитов, которые постоянно растут 
и в конечном итоге становятся непригодными для обслуживания. За последние несколько лет мы увидели его преимущества 
во многих средних и крупномасштабных проектах. Идея состоит в том, чтобы разбить большую систему на несколько 
более мелких автономных систем (SCS), которые следуют определенным правилам. Рассмотрим характеристики СКС:

- Каждый SCS представляет собой автономное веб-приложение. Для каждого домена SCS все его данные, 
 логика обработки этих данных и код, необходимый для отображения веб-интерфейса, содержатся в SCS. 
 SCS может выполнять свои основные задачи самостоятельно, не полагаясь на наличие других доступных систем.
- Каждый SCS принадлежит одной команде. Это не обязательно означает, что только одна команда может изменить код, 
 но вместо этого это означает, что последнее слово в отношении того, что входит в базу кода, 
 остается за командой-владельцем — например, путем объединения запросов на включение.
- Связь с другими SCS или сторонними системами по возможности осуществляется асинхронно. 
 В частности, доступ к другим SCS или внешним системам не должен осуществляться синхронно в рамках собственного цикла 
 запроса/ответа SCS. Это отделяет системы, тем самым уменьшая последствия сбоев и тем самым поддерживая автономность. 
 SCS должен работать, даже если другие SCS временно отключены от сети. Этого можно достичь, даже если связь 
 на техническом уровне является синхронной, например. путем репликации данных или буферизации запросов.
- SCS может иметь дополнительный сервисный API. Поскольку SC имеет собственный веб-интерфейс пользователя, 
 он может взаимодействовать с пользователем без использования службы пользовательского интерфейса. 
 Однако API для мобильных клиентов или других SCS может оказаться полезным.
- Каждая SCS должна включать данные и логику. SCS должен реализовывать функции самостоятельно, а для реальной 
 реализации каких-либо значимых функций необходимы оба.
- SCS должена сделать свои функции доступными для конечных пользователей благодаря собственному пользовательскому 
 интерфейсу. Таким образом, SCS не должен иметь общего пользовательского интерфейса с другими SCS. 
 SCS могут по-прежнему иметь связи друг с другом; однако асинхронная интеграция означает, что SCS должен работать, 
 даже если пользовательский интерфейс другого SCS недоступен.
- Чтобы избежать жесткой связи, SCS никогда не должен совместно использовать бизнес-код с другими SCS. 
 Однако можно создать запрос на включение для SCS или использовать общие библиотеки, 
 например драйверы базы данных или клиенты OAuth.

Для получения дополнительной информации посетите веб-сайт [автономных систем](https://scs-architecture.org/). 

## 1.8 Подведение итогов
В ходе этой главы вы узнали:

- Проектирование, ориентированное на предметную область, не связано с технологией; на самом деле речь идет о создании 
 ценности в области, в которой вы работаете, путем сосредоточения внимания на модели. Каждый принимает участие 
 в процессе разработки предметной области, а разработчики и эксперты предметной области объединяются для создания 
 базы знаний, используя один и тот же язык — вездесущий язык.
- Предметно-ориентированное проектирование предоставляет инструменты тактического и стратегического моделирования 
 для разработки высококачественного программного обеспечения. Стратегический дизайн ориентирован на направление бизнеса,
 помогает определить внутренние отношения и технически защищает каждую бизнес-услугу, определяя четкие границы. 
 Тактическое проектирование обеспечивает полезные строительные блоки для итеративного проектирования.
- Мы изучили контекст, в котором имеет смысл проектирование, ориентированное на предметную область. 
 Это не панацея от всех проблем в программном обеспечении, поэтому будете ли вы использовать ее или нет, 
 во многом зависит от сложности, с которой вы имеете дело.
- Мы также увидели, что применение предметно-ориентированного проектирования — это долгосрочная инвестиция; 
 это требует активных усилий. Эксперты по предметной области должны будут тесно сотрудничать с разработчиками, 
 а разработчикам придется думать с точки зрения бизнеса. В конце концов, бизнес-клиент должен быть доволен.

Реализация доменно-ориентированного проектирования требует усилий. Если бы это было легко, 
все бы писали высококачественный код. Будьте готовы, ведь вскоре вы научитесь писать код, который при прочтении 
будет идеально описывать бизнес, которым занимается ваша компания. Наслаждайтесь этим путешествием!
